!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e=e||self).DiagramEngine=n()}(this,function(){var e=function(){function e(){}return e.setEnginePath=function(n){e.enginePath=n},e.setErrorHandler=function(n){e.globalErrorHandler=n},e.renderDiagram=function(n){var r=n.container,t=n.type,a=n.code,i=n.theme;try{if(!e.enginePath)throw new Error("Diagram Engine path not set, use DiagramEngine.setEnginePath('path-to-engine')");var o="string"==typeof r?document.querySelector(r):r;if(!o)throw new Error("Could not find container DOM element");return Promise.resolve(e.initContainer(o)).then(function(e){e.contentWindow.postMessage({type:"render-diagram",data:{type:t,code:a,theme:i}},"*")})}catch(e){return Promise.reject(e)}},e.initContainer=function(n){try{return Promise.resolve(new Promise(function(r){var t=n.querySelector("iframe[diagram-renderer]");t?r(t):(n.innerHTML="",(t=document.createElement("iframe")).style.width="100%",t.style.height="100%",t.style.border="none",t.style.minWidth="400px",t.style.minHeight="400px",t.setAttribute("diagram-renderer",""),t.src=e.enginePath,e.addMessageHandler("diagram-render-engine-ready",t,function(e){e.data&&"diagram-render-engine-ready"===e.data.type&&r(t)},!0),n.appendChild(t))}))}catch(e){return Promise.reject(e)}},e.addMessageHandler=function(n,r,t,a){e.handlers.push({eventName:n,iframe:r,cb:t})},e}();return window.addEventListener("message",function(n){if(n.data&&n.data.type){var r=e.handlers.find(function(e){return e.eventName===n.data.type&&e.iframe.contentWindow===n.source});if(r&&(r.cb(n),r.once)){var t=e.handlers.indexOf(r);e.handlers.splice(t,1)}n.data&&"diagram-render-error"===n.data.type&&e.globalErrorHandler&&e.globalErrorHandler(n.data)}}),e.handlers=[],e});
//# sourceMappingURL=diagram-codes-engine-client.umd.js.map
